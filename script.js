/* const productsData = [
  {
    title: "–°–≤—ñ—á–∫–∞ ¬´–°–æ–ª–æ–¥–∫–∏–π —Ä–∞–π¬ª",
    images: ["1.jpg"],
    description: "–°–æ–ª–æ–¥–∫–∏–π –∞—Ä–æ–º–∞—Ç –≤–∞–Ω—ñ–ª—ñ —Ç–∞ —Ñ—Ä—É–∫—Ç—ñ–≤. –Ü–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∑–∞—Ç–∏—à–∫—É.",
    price: 150
  },
  {
    title: "–°–≤—ñ—á–∫–∞ ¬´–®–æ–∫–æ–ª–∞–¥–Ω–∏–π –º–∞—Ñ—ñ–Ω¬ª",
    images: ["2.jpg"],
    description: "–ê—Ä–æ–º–∞—Ç —Å–≤—ñ–∂–æ—ó –≤–∏–ø—ñ—á–∫–∏ –∑ –Ω–æ—Ç–∫–∞–º–∏ —à–æ–∫–æ–ª–∞–¥—É.",
    price: 170
  },
  {
    title: "–°–≤—ñ—á–∫–∞ ¬´–Ø–≥—ñ–¥–Ω–∏–π –¥–µ—Å–µ—Ä—Ç¬ª",
    images: ["3.jpg"],
    description: "–Ø–≥—ñ–¥–Ω–∞ –∫–æ–º–ø–æ–∑–∏—Ü—ñ—è –¥–ª—è —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–æ–≥–æ –≤–µ—á–æ—Ä–∞.",
    price: 160
  },
  {
    title: "–°–≤—ñ—á–∫–∞ ¬´–ì—Ä–∞–Ω–∞—Ç–æ–≤–∏–π —Å–∏–¥—Ä¬ª",
    images: ["garnet1.jpg", "garnet2.jpg", "garnet3.jpg"],
    description: "–°–æ–∫–æ–≤–∏—Ç–∏–π –≥—Ä–∞–Ω–∞—Ç —ñ–∑ –ø—Ä—è–Ω–∏–º–∏ –Ω–æ—Ç–∞–º–∏ ‚Äî —è—Å–∫—Ä–∞–≤–∏–π –∞—Ä–æ–º–∞—Ç —Å–µ–∑–æ–Ω—É.",
    price: 225
  },
  {
    title: "–°–≤—ñ—á–∫–∞ ¬´Limoncello Cr√®me¬ª",
    images: ["limoncello1.jpg", "limoncello2.jpg", "limoncello3.jpg"],
    description: "–°–≤—ñ–∂–∏–π –ª–∏–º–æ–Ω –∑ –≤–µ—Ä—à–∫–æ–≤–∏–º –∫—Ä–µ–º–æ–º. –õ—ñ—Ç–Ω—ñ–π –Ω–∞—Å—Ç—Ä—ñ–π —É –±–∞–Ω—Ü—ñ.",
    price: 350
  },
  {
    title: "–°–≤—ñ—á–∫–∞ ¬´Coconut¬ª",
    images: ["coconut1.jpg", "coconut2.jpg", "coconut3.jpg"],
    description: "–ö–æ–∫–æ—Å–æ–≤–∞ –Ω—ñ–∂–Ω—ñ—Å—Ç—å —ñ–∑ —Ç—Ä–æ–ø—ñ—á–Ω–∏–º –∞—Ä–æ–º–∞—Ç–æ–º.",
    price: 280
  },
  {
    title: "–°–≤—ñ—á–∫–∞ ¬´–ë–∞–≤–æ–≤–Ω–∞ —Ç–∞ –Ü—Ä–∏—Å¬ª",
    images: ["6.jpg"],
    description: "–õ–µ–≥–∫–∏–π –∞—Ä–æ–º–∞—Ç –±–∞–≤–æ–≤–Ω–∏ –∑ –∫–≤—ñ—Ç–∫–æ–≤–∏–º–∏ –Ω–æ—Ç–∫–∞–º–∏ —ñ—Ä–∏—Å—É.",
    price: 225
  },

{
  title: "–°–≤—ñ—á–∫–∞ ¬´Toskana¬ª",
  images: ["toskana1.jpg", "toskana2.jpg", "toskana3.jpg"],
  description: "–°–µ—Ä—ñ—è –∞—Ä–æ–º–∞—Ç–∏—á–Ω–∏—Ö —Å–≤—ñ—á–æ–∫ –∑ —ñ—Ç–∞–ª—ñ–π—Å—å–∫–∏–º —à–∞—Ä–º–æ–º –¢–æ—Å–∫–∞–Ω–∏.",
  price: 265
},
{
  title: "–°–≤—ñ—á–∫–∞ ¬´Roses¬ª",
  images: ["roses1.jpg", "roses2.jpg", "roses3.jpg"],
  description: "–†–æ–º–∞–Ω—Ç–∏—á–Ω–∞ —Å–µ—Ä—ñ—è –∑ –∞—Ä–æ–º–∞—Ç–æ–º —Ç—Ä–æ—è–Ω–¥. –Ü–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –≤–µ—á–æ—Ä–∞.",
  price: 240
},
{
  title: "–°–≤—ñ—á–∫–∞ ¬´Heart Collection¬ª",
  images: ["heart1.jpg", "heart2.jpg", "heart3.jpg"],
  description: "–ü–æ–¥–∞—Ä—É–Ω–∫–æ–≤—ñ —Å–≤—ñ—á–∫–∏ —É —Ñ–æ—Ä–º—ñ —Å–µ—Ä—Ü—è –¥–ª—è –æ—Å–æ–±–ª–∏–≤–∏—Ö –º–æ–º–µ–Ω—Ç—ñ–≤.",
  price: 220
}

];

*/


let cart = [];

function addToCart(title, price) {
  const existing = cart.find(item => item.title === title);
  if (existing) {
    if (existing.quantity < 10) {
      existing.quantity += 1;
    } else {
      alert("–ú–∞–∫—Å–∏–º—É–º 10 –æ–¥–∏–Ω–∏—Ü—å –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä—É.");
      return;
    }
  } else {
    cart.push({ title, price, quantity: 1 });
  }
  updateCartCount();
  showCartNotification();
}


function addFromModalToCart(title, price) {
  const input = document.querySelector('#productModalContent input[type="number"]');
  const quantity = parseInt(input.value);

  const existing = cart.find(item => item.title === title);
  if (existing) {
    if (existing.quantity + quantity > 10) {
      alert("–ú–∞–∫—Å–∏–º—É–º 10 –æ–¥–∏–Ω–∏—Ü—å –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä—É.");
      existing.quantity = 10;
    } else {
      existing.quantity += quantity;
    }
  } else {
    cart.push({ title, price, quantity });
  }

  updateCartCount();
  showAddToCartNotification(); // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û!
}


 
function getProductPriceByTitle(title) {
  const productElement = [...document.querySelectorAll('.product')].find(el => el.querySelector('h3').textContent === title);
  if (!productElement) return 0;
  const priceText = productElement.querySelector('p').textContent.replace('‚Ç¥', '');
  return parseInt(priceText);
}


function updateCartCount() {
  const count = cart.reduce((sum, item) => sum + item.quantity, 0);
  document.getElementById("cartCount").textContent = count;
}

function openCart() {
  const cartItemsContainer = document.getElementById("cartItems");
  cartItemsContainer.innerHTML = "";

  let total = 0;

  cart.forEach((item, index) => {
    const itemTotal = item.price * item.quantity;

    const itemDiv = document.createElement("div");
    itemDiv.className = "cart-item";

    itemDiv.innerHTML = `
      <div class="item-info">
        <span class="item-name">${item.title}</span>
        <span class="item-price">‚Ç¥${item.price} √ó ${item.quantity} = ‚Ç¥${itemTotal}</span>
      </div>
      <div class="item-controls">
        <button onclick="changeQuantity(${index}, -1)">‚àí</button>
        <span>${item.quantity}</span>
        <button onclick="changeQuantity(${index}, 1)">+</button>
        <button onclick="removeFromCart(${index})">üóëÔ∏è</button>
      </div>
    `;

    cartItemsContainer.appendChild(itemDiv);
    total += itemTotal;
  });

  document.getElementById("cartTotal").textContent = `‚Ç¥${total}`;
  document.getElementById("cartModal").style.display = "block";
}

function closeCart() {
  document.getElementById("cartModal").style.display = "none";
}

function removeFromCart(index) {
  cart.splice(index, 1);
  updateCartCount();
  openCart();
}

function changeQuantity(index, delta) {
  const item = cart[index];
  item.quantity += delta;
  if (item.quantity < 1) item.quantity = 1;
  if (item.quantity > 10) item.quantity = 10;
  updateCartCount();
  openCart();
}

function showCartNotification() {
  const notification = document.getElementById("cartNotification");
  notification.style.display = "flex";

  setTimeout(() => {
    notification.style.display = "none";
  }, 2000);
}



function renderProducts(products) {
  const container = document.getElementById("products");
  if (!container) return;

  container.innerHTML = "";

  products.forEach(product => {
    const div = document.createElement("div");
    div.className = "product";

    const img = document.createElement("img");
    img.src = product.images[0];

    img.alt = product.title;
    img.addEventListener("click", () => openProductModal(product.title));

    const h3 = document.createElement("h3");
    h3.textContent = product.title;

    const p = document.createElement("p");
    p.textContent = `‚Ç¥${product.price}`;

    const btn = document.createElement("button");
    btn.className = "order-direct-btn";
    btn.textContent = "–ó–∞–º–æ–≤–∏—Ç–∏";
    btn.addEventListener("click", () => openProductModal(product.title));

    div.appendChild(img);
    div.appendChild(h3);
    div.appendChild(p);
    div.appendChild(btn);

    container.appendChild(div);
  });
}




document.addEventListener("DOMContentLoaded", function () {
fetch("products.json")

  .then(res => res.json())
  .then(data => {
    window.productsData = data;
    renderProducts(data);
  })
  .catch(err => {
    console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤:", err);
  });

  const deliverySelect = document.getElementById("delivery");
  const warning = document.getElementById("ukrpostWarning");
  const submitBtn = document.getElementById("submitOrderBtn");

  if (deliverySelect && warning && submitBtn) {
    deliverySelect.addEventListener("change", function () {
      if (this.value === "–£–∫—Ä–ø–æ—à—Ç–∞") {
        warning.style.display = "block";
        submitBtn.disabled = true;
        submitBtn.style.opacity = "0.6";
        submitBtn.style.cursor = "not-allowed";
      } else {
        warning.style.display = "none";
        submitBtn.disabled = false;
        submitBtn.style.opacity = "1";
        submitBtn.style.cursor = "pointer";
      }
    });
  }
});



document.getElementById("orderForm").addEventListener("submit", function (e) {
  e.preventDefault();

 const name = this.name.value.trim();
const surname = this.surname.value.trim();
const phone = this.phone.value.trim();
const city = this.address.value.trim(); // –º—ñ—Å—Ç–æ
const delivery = this.delivery.value;
const warehouse = this.warehouse.value.trim(); // –Ω–æ–º–µ—Ä –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è

if (cart.length === 0) {
  alert("–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π!");
  return;
}

let message = `üõí *–ù–æ–≤–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è!*\n\n`;
message += `üë§ –Ü–º‚Äô—è: ${name} ${surname}\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: ${phone}\n`;
message += `üèô –ú—ñ—Å—Ç–æ: ${city}\nüè§ –í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è: ${warehouse}\nüöö –ü–æ—à—Ç–∞: ${delivery}\n\n`;
message += `üïØ *–¢–æ–≤–∞—Ä–∏:*\n`;

let total = 0;
cart.forEach((item, i) => {
  const itemTotal = item.price * item.quantity;
  message += `${i + 1}) ${item.title} ‚Äî ‚Ç¥${item.price} √ó ${item.quantity} = ‚Ç¥${itemTotal}\n`;
  total += itemTotal;
});

message += `\nüí∞ *–†–∞–∑–æ–º:* ‚Ç¥${total}`;


  const token = "8049436425:AAHZ-SSBjhu5C8JfSvjhgyHT7i6UOVlx2F0";
  const chatId = "702004730";

  fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      chat_id: chatId,
      text: message,
      parse_mode: "Markdown",
    }),
  })
    .then((res) => {
      if (res.ok) {
        alert("–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ! –ú–∏ –∑–≤‚Äô—è–∂–µ–º–æ—Å—è –∑ –≤–∞–º–∏.");
        closeCart();
        this.reset();
        cart = [];
        updateCartCount();
      } else {
        alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.");
      }
    })
    .catch((err) => {
      console.error("Telegram error:", err);
      alert("–ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ Telegram.");
    });
});

// –ó–º—ñ–Ω–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –Ω–∞ –∫–∞—Ä—Ç—Ü—ñ —Ç–æ–≤–∞—Ä—É
function changeProductQty(button, delta) {
  const container = button.parentElement;
  const input = container.querySelector("input");
  let value = parseInt(input.value);
  value += delta;

  if (value < 1) value = 1;
  if (value > 10) value = 10;

  input.value = value;
}

// –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–æ–≤–∞—Ä—É –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é
function addToCartWithQty(title, price, button) {
  const quantityInput = button.previousElementSibling.querySelector("input");
  const quantity = parseInt(quantityInput.value);

  const existing = cart.find(item => item.title === title);
  if (existing) {
    if (existing.quantity + quantity > 10) {
      alert("–ú–∞–∫—Å–∏–º—É–º 10 –æ–¥–∏–Ω–∏—Ü—å –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä—É.");
      existing.quantity = 10;
    } else {
      existing.quantity += quantity;
    }
  } else {
    cart.push({ title, price, quantity });
  }

  updateCartCount();
  showCartNotification();
}


let currentImageIndex = 0;




function openProductModal(title) {
  const product = (window.productsData || []).find(p => p.title === title);

  if (!product) return;

  const images = product.images;
  currentImageIndex = 0;

  const html = `
    <h2>${product.title}</h2>

    <div class="modal-image-container">
      <button class="modal-arrow left" onclick="event.stopPropagation(); changeImage(-1)">&#10094;</button>
      <img id="sliderImage" src="${images[0]}" class="modal-image" style="cursor: zoom-in;" onclick="openFullScreen(this.src)" />

      <button class="modal-arrow right" onclick="event.stopPropagation(); changeImage(1)">&#10095;</button>
    </div>

    <div class="modal-tabs">
      <button class="tab-button active" onclick="switchTab('description')">–û–ø–∏—Å</button>
      <button class="tab-button" onclick="switchTab('reviews')">–í—ñ–¥–≥—É–∫–∏</button>
      <button class="tab-button" onclick="switchTab('specs')">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</button>
    </div>

    <div class="tab-content">
      <div id="description" class="tab-section active">
        <p>${product.description}</p>
      </div>
      <div id="reviews" class="tab-section">
        <p>–©–µ –Ω–µ–º–∞—î –≤—ñ–¥–≥—É–∫—ñ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä—à–∏–º!</p>
      </div>
      <div id="specs" class="tab-section">
        <ul>
          <li>–ú–∞—Ç–µ—Ä—ñ–∞–ª: –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏–π –≤—ñ—Å–∫</li>
          <li>–ê—Ä–æ–º–∞—Ç: —Ç—Ä–æ–ø—ñ—á–Ω–∏–π</li>
          <li>–ß–∞—Å –≥–æ—Ä—ñ–Ω–Ω—è: ~30 –≥–æ–¥</li>
        </ul>
      </div>
    </div>

    <div class="quantity-control">
      <button onclick="changeProductQty(this, -1)">‚àí</button>
      <input type="number" value="1" min="1" max="10" readonly />
      <button onclick="changeProductQty(this, 1)">+</button>
    </div>
    <button class="order-btn" onclick="addFromModalToCart('${product.title}', ${product.price})">–ó–∞–º–æ–≤–∏—Ç–∏</button>
  `;

  const modalContent = document.getElementById("productModalContent");
  modalContent.innerHTML = html;
  modalContent.dataset.images = JSON.stringify(images);
  document.getElementById("productModal").style.display = "block";
}



function changeImage(direction) {
  const modalContent = document.getElementById("productModalContent");
  const images = JSON.parse(modalContent.dataset.images);
  const imageElement = document.getElementById("sliderImage");

  currentImageIndex += direction;
  if (currentImageIndex < 0) currentImageIndex = images.length - 1;
  if (currentImageIndex >= images.length) currentImageIndex = 0;

  imageElement.classList.add("fade-out");
  setTimeout(() => {
    imageElement.src = images[currentImageIndex];
    imageElement.classList.remove("fade-out");
  }, 200);
}

function closeProductModal() {
  document.getElementById("productModal").style.display = "none";
}



function switchTab(tabId) {
  document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
  document.querySelectorAll('.tab-section').forEach(sec => sec.classList.remove('active'));

  document.querySelector(`.tab-button[onclick*="${tabId}"]`).classList.add('active');
  document.getElementById(tabId).classList.add('active');
}

document.addEventListener("DOMContentLoaded", function () {
  const deliverySelect = document.getElementById("deliverySelect");
  const warning = document.getElementById("ukrpostWarning");

  deliverySelect.addEventListener("change", function () {
    if (this.value === "–£–∫—Ä–ø–æ—à—Ç–∞") {
      warning.style.display = "block";
    } else {
      warning.style.display = "none";
    }
  });
});


function openFullScreen(imageSrc) {
  const fullscreenOverlay = document.createElement("div");
  fullscreenOverlay.style.position = "fixed";
  fullscreenOverlay.style.top = "0";
  fullscreenOverlay.style.left = "0";
  fullscreenOverlay.style.width = "100%";
  fullscreenOverlay.style.height = "100%";
  fullscreenOverlay.style.backgroundColor = "rgba(0, 0, 0, 0.95)";
  fullscreenOverlay.style.display = "flex";
  fullscreenOverlay.style.justifyContent = "center";
  fullscreenOverlay.style.alignItems = "center";
  fullscreenOverlay.style.zIndex = "3000";
  fullscreenOverlay.style.cursor = "zoom-out";

  const fullImg = document.createElement("img");
  fullImg.src = imageSrc;
  fullImg.style.maxWidth = "90%";
  fullImg.style.maxHeight = "90%";
  fullImg.style.boxShadow = "0 0 20px rgba(255,255,255,0.3)";
  fullImg.alt = "–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è";

  fullscreenOverlay.appendChild(fullImg);

  fullscreenOverlay.addEventListener("click", () => {
    document.body.removeChild(fullscreenOverlay);
  });

  document.body.appendChild(fullscreenOverlay);
}


document.addEventListener("DOMContentLoaded", function () {
  const searchInput = document.getElementById("searchInput");

  if (searchInput) {
    searchInput.addEventListener("input", function () {
  const query = this.value.toLowerCase();
  const products = document.querySelectorAll(".product");
  const noResults = document.getElementById("noResults");

  let matches = 0;

  products.forEach((product) => {
    const title = product.querySelector("h3").textContent.toLowerCase();
    const match = title.includes(query);
    product.style.display = match ? "block" : "none";
    if (match) matches++;
  });

  if (matches === 0) {
    noResults.style.display = "block";
  } else {
    noResults.style.display = "none";
  }
});

  }
});




document.getElementById("openCategories").addEventListener("click", () => {
  document.getElementById("categoryPanel").classList.add("open");
});

document.getElementById("closeCategories").addEventListener("click", () => {
  document.getElementById("categoryPanel").classList.remove("open");
});


function showAddToCartNotification() {
  const notification = document.getElementById("addToCartNotification");
  notification.style.display = "block";

  setTimeout(() => {
    notification.style.display = "none";
  }, 2000);
}

